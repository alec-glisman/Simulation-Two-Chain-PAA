# Allow restarting (continuing) previous simulation
RESTART

# Select groups with MDAnalysis syntax
c1: GROUP NDX_FILE=index.ndx NDX_GROUP=Chain_A
c2: GROUP NDX_FILE=index.ndx NDX_GROUP=Chain_B

# treat each molecule as whole
# rebuild molecules that are split by the periodic boundary conditions,
# avoid discontinuities changes in the CV value and artifacts in the calculations
WHOLEMOLECULES ENTITY0=c1, ENTITY1=c2

# Compute radius of gyration for chains
rg1: GYRATION ATOMS=c1
rg2: GYRATION ATOMS=c2

# Compute the center of mass for chains
cm1: COM ATOMS=c1
cm2: COM ATOMS=c2

# Compute the distance between the chain center of masses
d12: DISTANCE ATOMS=cm1,cm2
d12comp: DISTANCE ATOMS=cm1,cm2 COMPONENTS

# Add harmonic restraint for two chain center of mass
harm: RESTRAINT ARG=d12 AT={INITIAL_Z_SPACING_NM} KAPPA={WALL_FORCE_CONST}

# Print both collective variables on COLVAR file every 50000 steps
PRINT ARG=d12,d12comp.x,d12comp.y,d12comp.z,rg1,rg2 RESTART=AUTO FILE=COLVAR.dat STRIDE=500
PRINT ARG=harm.bias,harm.force2 RESTART=AUTO FILE=BIAS_HARMONIC.dat STRIDE=500
